# ルーム仕様

オンライン UNO ゲーム「ドボン UNO」のルーム管理仕様書。

---

## 1. ユーザー参加

ユーザーは自分の名前（必須）を入力してゲームに参加する。

---

## 2. ルームの役割

| 役割     | 説明                             | 権限                   |
| -------- | -------------------------------- | ---------------------- |
| オーナー | ルームを作成したプレイヤー       | ゲーム開始、ルーム解散 |
| 参加者   | 既存のルームに参加したプレイヤー | なし                   |

---

## 3. ルームの作成・参加

### ルーム作成

1. 「ルームを作成」を選択
2. ルームが作成され、オーナーとなる
3. 他のプレイヤーの参加を待つ

### ルーム参加

1. 「ルームに参加」を選択
2. 参加可能なルーム一覧から選択
3. ルームに参加し、参加者となる

---

## 4. ゲームの開始・終了

| 項目         | 条件                                                                     |
| ------------ | ------------------------------------------------------------------------ |
| プレイヤー数 | 3〜6 人                                                                  |
| ゲーム開始   | オーナーのみ可、3 人以上で開始可能                                       |
| 途中参加     | 不可                                                                     |
| ルーム終了   | ゲーム終了後、次のゲーム開始前にオーナーが選択可能（ゲーム中は終了不可） |

---

## 5. 途中退出

### オーナーが退出

- オーナー権限は次のプレイヤー（参加順）に移譲
- ゲーム中の場合、手札は除外
- ルームは継続

### 参加者が退出

- ゲーム中の場合、手札は除外（点数計算にも含まれない）
- そのゲームでの復帰は不可
- 次のゲームから再参加可能

### 退出時の効果処理

| 状況                                   | 処理                                                             |
| -------------------------------------- | ---------------------------------------------------------------- |
| 退出者の手番だった                     | 次のプレイヤーに手番が移る                                       |
| ドロー累積対象者がドローを引かずに退出 | 次のプレイヤーが累積対象となる                                   |
| 色選択中に退出                         | ランダムな色となる                                               |
| ドボン宣言後に退出                     | ドボンは有効、点数計算してゲーム終了（点数は退出者に支払われる） |

### プレイヤーが 1 人になった場合

- ゲーム中: 残ったプレイヤーの勝利となり、**ルームは終了**する（点数計算なし）
- 待機中: **ルームは終了**する

---

## 6. 接続切れ

通信エラーや接続切れが発生した場合、**即座に途中退出扱い**となる。
退出時にタイムアウト処理（パス、累積分を引くなど）が実行された後、退出処理が行われる。
再接続したい場合は、次のゲームから再度ルームに参加する。
